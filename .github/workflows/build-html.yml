name: Conversion PDF ‚ûú HTML uniquement

on:
  push:
    paths:
      - "plaquettes/**.pdf"
      - "scripts/convert_pdf_to_html.py"
      - ".github/workflows/convert-only.yml"

jobs:
  convert:
    runs-on: ubuntu-latest

    steps:
      - name: üì• Checkout du d√©p√¥t
        uses: actions/checkout@v3

      - name: üêç Installer Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: üì¶ Installer les d√©pendances n√©cessaires
        run: |
          python -m pip install --upgrade pip
          pip install pdf2image pillow

      - name: üîß Installer Poppler (n√©cessaire pour pdf2image)
        run: sudo apt-get update && sudo apt-get install -y poppler-utils

      - name: üóÇÔ∏è Cr√©er le dossier de sortie (si absent)
        run: mkdir -p html_plaquettes

      - name: üñ®Ô∏è Lancer la conversion PDF ‚ûú HTML
        run: python scripts/convert_pdf_to_html.py

      - name: üì§ Commit & Push des fichiers g√©n√©r√©s
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add html_plaquettes/*.html html_plaquettes/*.png
          git diff --cached --quiet || git commit -m "üñºÔ∏è Conversion PDF ‚ûú HTML automatique"
          git push https://x-access-token:${{ secrets.GH_PAT }}@github.com/${{ github.repository }}.git

# name: G√©n√©rer les plaquettes HTML

# on:
#   push:
#     paths:
#       - "plaquettes/**.pdf"
#       - "scripts/*.py"
#       - "index.html"
#       - ".github/workflows/build-html.yml"

# jobs:
#   generate:
#     runs-on: ubuntu-latest

#     steps:
#       - name: Checkout du d√©p√¥t
#         uses: actions/checkout@v3

#       - name: Installer Python
#         uses: actions/setup-python@v4
#         with:
#           python-version: "3.11"

#       - name: Installer les d√©pendances Python
#         run: |
#           python -m pip install --upgrade pip
#           pip install pdf2image pillow

#       - name: Installer Poppler (pour pdf2image)
#         run: sudo apt-get update && sudo apt-get install -y poppler-utils

#       - name: Cr√©er le dossier de sortie (si absent)
#         run: mkdir -p html_plaquettes

#       - name: G√©n√©rer les versions HTML depuis PDF
#         run: python scripts/convert_pdf_to_html.py

#       - name: Mettre √† jour index.html
#         run: python scripts/generate_index.py

#       - name: Commit et push des fichiers g√©n√©r√©s
#         run: |
#           git config user.name "GitHub Actions"
#           git config user.email "actions@github.com"
#           git add html_plaquettes/*.html html_plaquettes/*.png index.html
#           git diff --cached --quiet || git commit -m "üîÑ G√©n√©ration automatique des HTML plaquettes + index"
#           git push
